(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[261],{8416:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/case-study/background/challenges_testing_microservices",function(){return n(8218)}])},9369:function(e,t,n){"use strict";var s=n(5893);n(7294);let i={logo:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("img",{src:"/transparent-logo-horizontal-mn.svg",style:{maxHeight:"5rem"},alt:"logo"})}),project:{link:"https://github.com/signet-framework/"},docsRepositoryBase:"https://github.com/signet-framework/case-study",footer:{text:""},editLink:{text:null},feedback:{content:null},head:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("link",{rel:"icon",type:"image/ico",href:"/signet-favicon-transparent.ico"})})};t.Z=i},8218:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var s=n(5893),i=n(2673),r=n(3931),o=n(9369);n(9966);var a=n(1151),c=n(5675),d=n.n(c),l={src:"/_next/static/media/image.0a265876.png",height:712,width:1716,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAMAAACZFr56AAAABlBMVEX8/Pzz8/Mq5Ki/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAFUlEQVR4nGNgYGBgZIAARkYEC8gHAABlAAft56SxAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:3};let h={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:t}=Object.assign({},(0,a.ah)(),e.components);return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)},pageOpts:{filePath:"pages/case-study/background/challenges_testing_microservices.md",route:"/case-study/background/challenges_testing_microservices",headings:[{depth:1,value:"Challenges Testing Microservices",id:"challenges-testing-microservices"},{depth:2,value:"Automated Testing",id:"automated-testing"},{depth:2,value:"Testing Microservices",id:"testing-microservices"},{depth:3,value:"Challenges with Integration Testing",id:"challenges-with-integration-testing"},{depth:3,value:"Challenges with E2E testing",id:"challenges-with-e2e-testing"},{depth:2,value:"The crux of the matter",id:"the-crux-of-the-matter"}],timestamp:1690240001e3,pageMap:[{kind:"Meta",data:{index:{title:"Home",display:"hidden",type:"page"},"case-study-header-link":{title:"Case Study",type:"page",href:"/case-study"},quickstart:"Quickstart","case-study":{title:"Case Study"},about:{title:"About",type:"page"},contact:{title:"Contact ↗",type:"page",href:"https://github.com/signet-framework/",newWindow:!0}}},{kind:"MdxPage",name:"about",route:"/about"},{kind:"Folder",name:"case-study",route:"/case-study",children:[{kind:"Meta",data:{background:"Background",contract_testing:"Contract Testing",signet_framework:"Signet Framework",design_decisions:"Design Decisions"}},{kind:"Folder",name:"background",route:"/case-study/background",children:[{kind:"Meta",data:{monoliths_and_microservices:"Monoliths and Microservices",challenges_testing_microservices:"Challenges Testing Microservices"}},{kind:"MdxPage",name:"challenges_testing_microservices",route:"/case-study/background/challenges_testing_microservices"},{kind:"MdxPage",name:"monoliths_and_microservices",route:"/case-study/background/monoliths_and_microservices"}]},{kind:"MdxPage",name:"contract_testing",route:"/case-study/contract_testing"},{kind:"Folder",name:"design_decisions",route:"/case-study/design_decisions",children:[{kind:"Meta",data:{provider_verification:"Provider Verification",central_document_repository:"Central Document Repository",contract_generation:"Contract Generation"}},{kind:"MdxPage",name:"central_document_repository",route:"/case-study/design_decisions/central_document_repository"},{kind:"MdxPage",name:"contract_generation",route:"/case-study/design_decisions/contract_generation"},{kind:"MdxPage",name:"provider_verification",route:"/case-study/design_decisions/provider_verification"}]},{kind:"Folder",name:"signet_framework",route:"/case-study/signet_framework",children:[{kind:"Meta",data:{usecase:"Use Case"}},{kind:"MdxPage",name:"usecase",route:"/case-study/signet_framework/usecase"}]}]},{kind:"MdxPage",name:"case-study",route:"/case-study"},{kind:"MdxPage",name:"index",route:"/"},{kind:"Folder",name:"quickstart",route:"/quickstart",children:[{kind:"Meta",data:{style_guide:"Style Guide",folders:"Folders and _meta.json",embed_image:"Embed an Image",mdx_with_react:"MDX with React"}},{kind:"MdxPage",name:"embed_image",route:"/quickstart/embed_image"},{kind:"MdxPage",name:"folders",route:"/quickstart/folders"},{kind:"MdxPage",name:"mdx_with_react",route:"/quickstart/mdx_with_react"},{kind:"MdxPage",name:"style_guide",route:"/quickstart/style_guide"}]},{kind:"MdxPage",name:"quickstart",route:"/quickstart"}],flexsearch:{codeblocks:!0},title:"Challenges Testing Microservices"},pageNextRoute:"/case-study/background/challenges_testing_microservices",nextraLayout:r.ZP,themeConfig:o.Z};function u(e){let t=Object.assign({h1:"h1",h2:"h2",p:"p",ul:"ul",li:"li",strong:"strong",em:"em",h3:"h3",blockquote:"blockquote",sup:"sup",a:"a",section:"section",ol:"ol"},(0,a.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{children:"Challenges Testing Microservices"}),"\n",(0,s.jsx)(t.h2,{id:"automated-testing",children:"Automated Testing"}),"\n",(0,s.jsx)(t.p,{children:"Automated software tests are broadly grouped into three categories:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Unit Tests"})," - test individual components of a program.\nThe subject under test is a single function, class, or some other unit of non-trivial programming logic."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Integration Tests"})," - test that multiple logical components of the system function correctly together."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"End-to-End Tests (E2E)"})," - exercise full-system workflows as they would occur when triggered in production."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Each type of test serves a unique purpose and has a place in a well-balanced test suite.\nA pyramid is often used to illustrate how each type of test relates to the others."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"TODO: This is a placeholder:"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(d(),{alt:"Alt text",placeholder:"blur",src:l})}),"\n",(0,s.jsx)(t.p,{children:"Tests which are higher on the pyramid have a broader scope and provide more confidence that the system works correctly.\nHowever, broadly-scoped tests take longer to run, and do less to pinpoint the exact cause of a failure."}),"\n",(0,s.jsx)(t.p,{children:"In contrast, tests that are lower on the pyramid execute more quickly and provide better isolation of bugs.\nHowever, these tests provide less confidence that the application works correctly as a whole."}),"\n",(0,s.jsx)(t.h2,{id:"testing-microservices",children:"Testing Microservices"}),"\n",(0,s.jsx)(t.p,{children:"Compared with monoliths, microservices have more to gain from tests that are high on the pyramid.\nThis is because API calls over the network are more complex and significantly less reliable than in-memory method calls.\nAn additional factor is that different microservices may be built by different teams.\nBroadly-scoped tests confirm that multiple teams understand each other correctly."}),"\n",(0,s.jsxs)(t.p,{children:["Let us explore an example which illustrates why broadly-scoped tests are so important for microservices.\nIn order to do that it will be helpful to think about services assuming the role of either a ",(0,s.jsx)(t.em,{children:"provider"})," or a ",(0,s.jsx)(t.em,{children:"consumer"}),"."]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Provider"})," - a service which exposes some functionality and/or data for other services to use"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Consumer"})," - a service which requires functionality and/or data from another service in order to fulfill its own requirements"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Microservices should be loosely coupled—one team should not need to know how another team's services are implemented.\nSuppose a provider team wants to change their service's API.\nIf the provider team does not know how the consumer services are implemented, it is easy for them to accidentally change the API in a way that breaks a consumer."}),"\n",(0,s.jsx)(t.p,{children:"Integration and E2E tests are well-suited to catch this type of error before it is introduced into production.\nHowever, applying broadly-scoped tests to microservices can hinder independent deployability, clear ownership, and rapid development cycles.\nIn the following section, we will explore why this is the case."}),"\n",(0,s.jsx)(t.h3,{id:"challenges-with-integration-testing",children:"Challenges with Integration Testing"}),"\n",(0,s.jsxs)(t.p,{children:["Independent deployability requires that new versions of a service can be built, deployed, and released with ",(0,s.jsx)(t.strong,{children:"minimal involvement from other teams"}),".\nHowever, in order for one team to perform integration tests with another team's service, they may need help with a number of things:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Knowing which version (or versions) of the other service are currently released"}),"\n",(0,s.jsx)(t.li,{children:"Setting up the other service's runtime environment, configuring the service, and starting it up in the correct way"}),"\n",(0,s.jsx)(t.li,{children:"Setting up and configuring the other service's external dependencies (this might require getting additional teams involved as well)"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["To address this problem, integration tests can be replaced with ",(0,s.jsx)(t.strong,{children:"service tests"}),", where the external service is replaced with a ",(0,s.jsx)(t.em,{children:"test double"}),".\nThe ",(0,s.jsx)(t.strong,{children:"test double"})," receives requests from the service being tested and sends back a canned response.\nThis enables a team to test the integration of their service with another, without actually spinning up the other service."]}),"\n",(0,s.jsx)(t.p,{children:"TODO: maybe diagram"}),"\n",(0,s.jsx)(t.p,{children:"However, service tests only work as long as the real provider's interface does not change; if the provider service changes, the test double needs to be updated as well.\nIdeally, there should be an automated way to validate that the test double is up to date with the real service it represents."}),"\n",(0,s.jsx)(t.h3,{id:"challenges-with-e2e-testing",children:"Challenges with E2E testing"}),"\n",(0,s.jsx)(t.p,{children:"The difficulties of testing microservices are even greater in the context of E2E testing.\nThere are many reasons for this, but we will take a look at two in particular."}),"\n",(0,s.jsx)(t.p,{children:"First, E2E testing requires simulating production conditions as best as possible in a dedicated testing environment.\nThis is incredibly challenging with a large number of microservices, as it requires one or more instances of every service in the application to be spun up in the environment.\nNot only is this expensive, it also becomes increasingly difficult to accomplish as the architecture grows."}),"\n",(0,s.jsxs)(t.p,{children:["In practice, E2E testing may require ",(0,s.jsx)(t.em,{children:"multiple"})," testing environments so that different teams can conduct tests on new versions of their service at the same time."]}),"\n",(0,s.jsx)(t.p,{children:"The second challenge is that E2E tests are slow.\nThey usually consist of consecutive user interactions and may execute synchronously to ensure repeatability and consistency of state across different test runs.\nE2E tests are especially slow for microservices because services interact through network calls, which are orders of magnitude slower than reading from memory."}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:['"I have seen [E2E tests] take up to a day to run, if not longer, and on one project I worked on, a full regression suite took six weeks!"',(0,s.jsx)(t.sup,{children:(0,s.jsx)(t.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})})]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Slow E2E test suites decrease the speed at which new features can be shipped because they slow down the developer feedback loop.\nIf it takes longer for developers to become aware that their changes broke something, it takes longer for them to fix it and start the CI/CD process over again."}),"\n",(0,s.jsx)(t.p,{children:"Thus, in order to effectively test microservices, we need ways to increase our confidence that the application works correctly as a whole, without compromising the key benefits that lead us to adopting microservices in the first place."}),"\n","\n",(0,s.jsx)(t.h2,{id:"the-crux-of-the-matter",children:"The crux of the matter"}),"\n",(0,s.jsx)(t.p,{children:"As we have seen, there are a number of things to consider when testing microservices. We want to have confidence that our services work correctly together.\nBut in doing so, we do not want to compromise the benefits of this style of architecture."}),"\n",(0,s.jsxs)(t.p,{children:["What we need are testing methodologies that catch the same bugs as integration and E2E tests, while maintaining a high degree of independent deployability and clear boundaries of ownership.","\nThese tests should also be faster, cheaper, and more maintainable than broadly-scoped tests. Contract testing is one such alternative, and it is there that we will turn our attention next."]}),"\n",(0,s.jsxs)(t.section,{"data-footnotes":!0,className:"footnotes",children:[(0,s.jsx)(t.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{id:"user-content-fn-1",children:["\n",(0,s.jsxs)(t.p,{children:["Sam Newman (Building Microservices - pg. 289) ",(0,s.jsx)(t.a,{href:"#user-content-fnref-1","data-footnote-backref":!0,className:"data-footnote-backref","aria-label":"Back to content",children:"↩"})]}),"\n"]}),"\n"]}),"\n"]})]})}var g=(0,i.j)(h)}},function(e){e.O(0,[533,774,888,179],function(){return e(e.s=8416)}),_N_E=e.O()}]);